{"timestamp": "2026-02-01T17:08:02.717897", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "2484c243", "path": "/", "method": "GET", "status_code": 200, "process_time": "4.44ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:08:04.433225", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "fdfdec08", "path": "/favicon.ico", "method": "GET", "status_code": 404, "process_time": "0.89ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:08:10.189627", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "883552f3", "path": "/docs", "method": "GET", "status_code": 200, "process_time": "1.37ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:08:11.933265", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "c123b0c4", "path": "/openapi.json", "method": "GET", "status_code": 200, "process_time": "114.52ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:17:36.903710", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "a8bc6da0", "path": "/api/doctor/sessions", "method": "GET", "status_code": 200, "process_time": "6749.38ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:17:51.275184", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "727215ad", "path": "/api/evidence/categories", "method": "GET", "status_code": 200, "process_time": "11469.96ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:17:52.825289", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "9030048e", "path": "/api/evidence/paper-types", "method": "GET", "status_code": 200, "process_time": "9722.92ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:17:57.244577", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.480s", "request_id": "5cd69981", "function": "get_files_with_pagination", "execution_time": 1.4804348945617676, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:17:57.245471", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.480s", "request_id": "5cd69981", "function": "get_files_with_pagination", "execution_time": 1.4804348945617676, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:00.015432", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "5cd69981", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "16913.72ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:01.491912", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "106ae70d", "path": "/api/evidence/categories", "method": "GET", "status_code": 200, "process_time": "8664.31ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:11.075206", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "7ff2af7b", "path": "/api/evidence/paper-types", "method": "GET", "status_code": 200, "process_time": "13806.71ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:13.497291", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.364s", "request_id": "6a9b5b5a", "function": "get_files_with_pagination", "execution_time": 1.3637511730194092, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:13.498004", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.364s", "request_id": "6a9b5b5a", "function": "get_files_with_pagination", "execution_time": 1.3637511730194092, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:15.040395", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.531s", "request_id": "0b806d36", "function": "get_files_with_pagination", "execution_time": 1.5311625003814697, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:15.041291", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.531s", "request_id": "0b806d36", "function": "get_files_with_pagination", "execution_time": 1.5311625003814697, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:16.470584", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.424s", "request_id": "d0320e89", "function": "get_files_with_pagination", "execution_time": 1.4236226081848145, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:16.471485", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.424s", "request_id": "d0320e89", "function": "get_files_with_pagination", "execution_time": 1.4236226081848145, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:16.473714", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "6a9b5b5a", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "14975.60ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:16.476125", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "0b806d36", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "14977.43ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:16.478168", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "d0320e89", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "14979.23ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:28.873907", "level": "INFO", "name": "api.evidence", "message": "Received search request with filters: {'min_total_score': 90, 'max_total_score': 100, 'skip': 0, 'limit': 100}", "request_id": "576643fb", "logger": "api.evidence"}
{"timestamp": "2026-02-01T17:18:30.188522", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_evidence_with_details executed in 1.314s", "request_id": "576643fb", "function": "get_evidence_with_details", "execution_time": 1.313640832901001, "args_count": 1, "kwargs_count": 4, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:30.189104", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_evidence_with_details took 1.314s", "request_id": "576643fb", "function": "get_evidence_with_details", "execution_time": 1.313640832901001, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:30.189711", "level": "INFO", "name": "api.evidence", "message": "Search completed successfully. Found 1 results.", "request_id": "576643fb", "logger": "api.evidence"}
{"timestamp": "2026-02-01T17:18:30.193616", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "576643fb", "path": "/api/evidence/search", "method": "POST", "status_code": 200, "process_time": "4918.91ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:18:39.317681", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.229s", "request_id": "2a9b909c", "function": "get_files_with_pagination", "execution_time": 1.2288181781768799, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:39.319426", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.229s", "request_id": "2a9b909c", "function": "get_files_with_pagination", "execution_time": 1.2288181781768799, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:18:39.325386", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "2a9b909c", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "4960.09ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:19:01.890907", "level": "INFO", "name": "api.evidence", "message": "Received search request with filters: {'min_total_score': 60, 'max_total_score': 100, 'skip': 0, 'limit': 100}", "request_id": "fbf97990", "logger": "api.evidence"}
{"timestamp": "2026-02-01T17:19:03.709584", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_evidence_with_details executed in 1.818s", "request_id": "fbf97990", "function": "get_evidence_with_details", "execution_time": 1.817875862121582, "args_count": 1, "kwargs_count": 4, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:19:03.710325", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_evidence_with_details took 1.818s", "request_id": "fbf97990", "function": "get_evidence_with_details", "execution_time": 1.817875862121582, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:19:03.710803", "level": "INFO", "name": "api.evidence", "message": "Search completed successfully. Found 100 results.", "request_id": "fbf97990", "logger": "api.evidence"}
{"timestamp": "2026-02-01T17:19:03.731541", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "fbf97990", "path": "/api/evidence/search", "method": "POST", "status_code": 200, "process_time": "5614.59ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:19:24.473799", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.430s", "request_id": "9564732d", "function": "get_files_with_pagination", "execution_time": 1.4303617477416992, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:19:24.475209", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.430s", "request_id": "9564732d", "function": "get_files_with_pagination", "execution_time": 1.4303617477416992, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:19:24.478834", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "9564732d", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "5166.72ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:19:53.342518", "level": "INFO", "name": "data_utils.vector_db", "message": "Successfully connected to Pinecone", "request_id": "715c867b", "logger": "data_utils.vector_db"}
{"timestamp": "2026-02-01T17:20:04.897387", "level": "INFO", "name": "utils.doctor_response", "message": "Starting doctor_response_with_context: hi...", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:04.898836", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting async query_doc with query: hi... on index: research", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:04.899758", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Attempting async similarity search on research (k=10)...", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:04.902349", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting async query_doc with query: hi... on index: expert", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:04.902874", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Attempting async similarity search on expert (k=10)...", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:04.904518", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting async query_doc with query: hi... on index: patient", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:04.905151", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Attempting async similarity search on patient (k=10)...", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:21.349665", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Retrieved 10 documents from vector DB", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:21.350472", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting reranking...", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:23.234334", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Reranking completed, got 3 reranked docs", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:23.235777", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Async query_doc on patient completed successfully", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:26.014707", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Retrieved 10 documents from vector DB", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:26.015288", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting reranking...", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:27.024052", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Reranking completed, got 3 reranked docs", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:27.025128", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Async query_doc on research completed successfully", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:40.622616", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Retrieved 10 documents from vector DB", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:40.623107", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Starting reranking...", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:41.259157", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Reranking completed, got 3 reranked docs", "request_id": "no-request-id", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:41.260434", "level": "INFO", "name": "Rag_Service.retrieval", "message": "Async query_doc on expert completed successfully", "request_id": "715c867b", "logger": "Rag_Service.retrieval"}
{"timestamp": "2026-02-01T17:20:41.261396", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: RAG Retrieval took 36.36s", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:41.269466", "level": "INFO", "name": "utils.doctor_response", "message": "Logged RAG interaction to testinglog.json", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:43.086541", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "715c867b", "path": "/api/doctor/stream", "method": "POST", "status_code": 200, "process_time": "69041.12ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:20:43.217486", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: First token took 1.95s from LLM start", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:49.016048", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "dfebd990", "path": "/api/doctor/sessions/9", "method": "PUT", "status_code": 200, "process_time": "5439.27ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:20:51.896515", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: Total stream took 10.63s", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:51.897054", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: Total Request took 47.00s", "request_id": "715c867b", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:20:52.657657", "level": "CRITICAL", "name": "utils.error_handler", "message": "UNHANDLED EXCEPTION: ValueError", "request_id": "715c867b", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 271, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 772, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 189, in __call__\n    |     raise app_exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 78, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    |     await response(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 270, in __call__\n    |     with collapse_excgroups():\n    |          ~~~~~~~~~~~~~~~~~~^^\n    |   File \"C:\\Users\\user\\AppData\\Roaming\\uv\\python\\cpython-3.13.5-windows-x86_64-none\\Lib\\contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 274, in wrap\n    |     await func()\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 254, in stream_response\n    |     async for chunk in self.body_iterator:\n    |     ...<2 lines>...\n    |         await send({\"type\": \"http.response.body\", \"body\": chunk, \"more_body\": True})\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\api\\doctor_chat_v2.py\", line 101, in generate_with_memory\n    |     logger.info(f\"Stream duration: {total_duration:.2fs}\")\n    |                                    ^^^^^^^^^^^^^^^^^^^^^\n    | ValueError: Invalid format specifier '.2fs' for object of type 'float'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 189, in __call__\n    raise app_exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await response(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 270, in __call__\n    with collapse_excgroups():\n         ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\user\\AppData\\Roaming\\uv\\python\\cpython-3.13.5-windows-x86_64-none\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 274, in wrap\n    await func()\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 254, in stream_response\n    async for chunk in self.body_iterator:\n    ...<2 lines>...\n        await send({\"type\": \"http.response.body\", \"body\": chunk, \"more_body\": True})\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\api\\doctor_chat_v2.py\", line 101, in generate_with_memory\n    logger.info(f\"Stream duration: {total_duration:.2fs}\")\n                                   ^^^^^^^^^^^^^^^^^^^^^\nValueError: Invalid format specifier '.2fs' for object of type 'float'", "exception_type": "ValueError", "exception_message": "Invalid format specifier '.2fs' for object of type 'float'", "path": "/api/doctor/stream", "method": "POST", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 271, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 772, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 189, in __call__\n    |     raise app_exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 78, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    |     await response(scope, receive, send)\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 270, in __call__\n    |     with collapse_excgroups():\n    |          ~~~~~~~~~~~~~~~~~~^^\n    |   File \"C:\\Users\\user\\AppData\\Roaming\\uv\\python\\cpython-3.13.5-windows-x86_64-none\\Lib\\contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 274, in wrap\n    |     await func()\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 254, in stream_response\n    |     async for chunk in self.body_iterator:\n    |     ...<2 lines>...\n    |         await send({\"type\": \"http.response.body\", \"body\": chunk, \"more_body\": True})\n    |   File \"C:\\Users\\user\\Desktop\\metamed_backend\\api\\doctor_chat_v2.py\", line 101, in generate_with_memory\n    |     logger.info(f\"Stream duration: {total_duration:.2fs}\")\n    |                                    ^^^^^^^^^^^^^^^^^^^^^\n    | ValueError: Invalid format specifier '.2fs' for object of type 'float'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 189, in __call__\n    raise app_exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await response(scope, receive, send)\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 270, in __call__\n    with collapse_excgroups():\n         ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\user\\AppData\\Roaming\\uv\\python\\cpython-3.13.5-windows-x86_64-none\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 274, in wrap\n    await func()\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\.venv\\Lib\\site-packages\\starlette\\responses.py\", line 254, in stream_response\n    async for chunk in self.body_iterator:\n    ...<2 lines>...\n        await send({\"type\": \"http.response.body\", \"body\": chunk, \"more_body\": True})\n  File \"C:\\Users\\user\\Desktop\\metamed_backend\\api\\doctor_chat_v2.py\", line 101, in generate_with_memory\n    logger.info(f\"Stream duration: {total_duration:.2fs}\")\n                                   ^^^^^^^^^^^^^^^^^^^^^\nValueError: Invalid format specifier '.2fs' for object of type 'float'\n", "logger": "utils.error_handler", "file": "C:\\Users\\user\\Desktop\\metamed_backend\\utils\\error_handler.py", "line": 170, "function": "unhandled_exception_handler"}
{"timestamp": "2026-02-01T17:20:54.674322", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "c235d1ab", "path": "/api/doctor/sessions", "method": "GET", "status_code": 200, "process_time": "5543.86ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:26:56.683083", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "783b14d6", "path": "/docs", "method": "GET", "status_code": 200, "process_time": "48.64ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:26:58.335748", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "6dfa16bc", "path": "/openapi.json", "method": "GET", "status_code": 200, "process_time": "314.42ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:29:51.688253", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "0fdda7a3", "path": "/docs", "method": "GET", "status_code": 200, "process_time": "4.82ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:29:52.376410", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "54656abc", "path": "/openapi.json", "method": "GET", "status_code": 200, "process_time": "73.68ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:30:06.150720", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "6c0ee41a", "path": "/api/doctor/sessions", "method": "GET", "status_code": 200, "process_time": "6581.01ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:30:14.905825", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "c921b056", "path": "/api/doctor/sessions/9/history", "method": "GET", "status_code": 200, "process_time": "5416.57ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:30:35.655431", "level": "INFO", "name": "data_utils.vector_db", "message": "Successfully connected to Pinecone", "request_id": "c96115f5", "logger": "data_utils.vector_db"}
{"timestamp": "2026-02-01T17:30:47.310990", "level": "INFO", "name": "utils.doctor_response", "message": "Starting doctor_response_with_context: hi...", "request_id": "c96115f5", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:30:47.311630", "level": "INFO", "name": "utils.doctor_response", "message": "Detected greeting intent in conversation, skipping RAG.", "request_id": "c96115f5", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:30:49.007397", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "c96115f5", "path": "/api/doctor/stream", "method": "POST", "status_code": 200, "process_time": "27444.76ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:30:49.120028", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: First token took 1.81s from LLM start", "request_id": "c96115f5", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:30:49.231820", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: Total stream took 1.92s", "request_id": "c96115f5", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:30:49.232559", "level": "INFO", "name": "utils.doctor_response", "message": "PERF: Total Request took 1.92s", "request_id": "c96115f5", "logger": "utils.doctor_response"}
{"timestamp": "2026-02-01T17:30:49.233268", "level": "INFO", "name": "api.doctor_chat_v2", "message": "Stream duration: 22.04s", "request_id": "c96115f5", "logger": "api.doctor_chat_v2"}
{"timestamp": "2026-02-01T17:31:00.224381", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "9df954fe", "path": "/api/doctor/sessions/8/history", "method": "GET", "status_code": 200, "process_time": "4915.41ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:08.765897", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "a15812a3", "path": "/api/doctor/sessions/9/history", "method": "GET", "status_code": 200, "process_time": "5125.60ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:23.205775", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "30ae360f", "path": "/api/evidence/categories", "method": "GET", "status_code": 200, "process_time": "10639.79ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:24.855689", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "b11852b6", "path": "/api/evidence/paper-types", "method": "GET", "status_code": 200, "process_time": "9635.10ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:29.151765", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.310s", "request_id": "f2502c76", "function": "get_files_with_pagination", "execution_time": 1.3102052211761475, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:29.152708", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.310s", "request_id": "f2502c76", "function": "get_files_with_pagination", "execution_time": 1.3102052211761475, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:31.692134", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "f2502c76", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "16472.11ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:32.915087", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "16a95156", "path": "/api/evidence/categories", "method": "GET", "status_code": 200, "process_time": "8057.77ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:42.475459", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "322ef45e", "path": "/api/evidence/paper-types", "method": "GET", "status_code": 200, "process_time": "13317.35ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:43.691670", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.211s", "request_id": "b7993c2b", "function": "get_files_with_pagination", "execution_time": 1.21144437789917, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:43.693088", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.211s", "request_id": "b7993c2b", "function": "get_files_with_pagination", "execution_time": 1.21144437789917, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:43.699469", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "b7993c2b", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "10782.12ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:45.878441", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.254s", "request_id": "ee0d9eed", "function": "get_files_with_pagination", "execution_time": 1.2543668746948242, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:45.879159", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.254s", "request_id": "ee0d9eed", "function": "get_files_with_pagination", "execution_time": 1.2543668746948242, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:47.295173", "level": "INFO", "name": "utils.performance_monitor", "message": "Performance: get_files_with_pagination executed in 1.410s", "request_id": "18ce4c0b", "function": "get_files_with_pagination", "execution_time": 1.409580945968628, "args_count": 3, "kwargs_count": 0, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:47.296957", "level": "WARNING", "name": "utils.performance_monitor", "message": "Slow query detected: get_files_with_pagination took 1.410s", "request_id": "18ce4c0b", "function": "get_files_with_pagination", "execution_time": 1.409580945968628, "performance_issue": true, "logger": "utils.performance_monitor"}
{"timestamp": "2026-02-01T17:31:47.304182", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "ee0d9eed", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "14381.49ms", "client_ip": "127.0.0.1", "logger": "root"}
{"timestamp": "2026-02-01T17:31:47.309694", "level": "INFO", "name": "root", "message": "Request completed", "request_id": "18ce4c0b", "path": "/api/evidence/files", "method": "GET", "status_code": 200, "process_time": "14385.84ms", "client_ip": "127.0.0.1", "logger": "root"}
